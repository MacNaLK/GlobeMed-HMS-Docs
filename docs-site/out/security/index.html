<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><title data-next-head="">Security Considerations ‚Äì GlobeMed HMS Documentation</title><meta name="robots" content="index,follow" data-next-head=""/><meta name="description" content="Security Considerations - GlobeMed Healthcare Management System Documentation" data-next-head=""/><meta property="og:title" content="Security Considerations ‚Äì GlobeMed HMS Documentation" data-next-head=""/><meta property="og:description" content="Security Considerations - GlobeMed Healthcare Management System Documentation" data-next-head=""/><style data-next-head="">
        :root {
          --nextra-primary-hue: 212deg;
          --nextra-primary-saturation: 100%;
          --nextra-navbar-height: 4rem;
          --nextra-menu-height: 3.75rem;
          --nextra-banner-height: 2.5rem;
        }
        
        .dark {
          --nextra-primary-hue: 204deg;
          --nextra-primary-saturation: 100%;
        }
      </style><meta name="msapplication-TileColor" content="#2563eb" data-next-head=""/><meta name="theme-color" content="#2563eb" data-next-head=""/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-next-head=""/><meta http-equiv="Content-Language" content="en" data-next-head=""/><meta name="description" content="GlobeMed Healthcare Management System Documentation - Design Patterns Implementation" data-next-head=""/><meta name="og:description" content="Comprehensive documentation for GlobeMed Healthcare Management System demonstrating advanced design patterns in Java" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="og:title" content="GlobeMed Healthcare Management System Documentation" data-next-head=""/><meta name="apple-mobile-web-app-title" content="GlobeMed HMS Docs" data-next-head=""/><link rel="icon" type="image/svg+xml" href="/favicon.svg" data-next-head=""/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" data-next-head=""/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" data-next-head=""/><link rel="preload" href="/_next/static/css/ce3c5654af17e98f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ce3c5654af17e98f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-6224d37324e372cb.js" defer=""></script><script src="/_next/static/chunks/framework-a6e0b7e30f98059a.js" defer=""></script><script src="/_next/static/chunks/main-1479fca3e0a4d49f.js" defer=""></script><script src="/_next/static/chunks/pages/_app-cd46b2f69a0aca78.js" defer=""></script><script src="/_next/static/chunks/181-25fb7bd8cd38c034.js" defer=""></script><script src="/_next/static/chunks/pages/security-625bb72d0eee18fe.js" defer=""></script><script src="/_next/static/vLk7-bKM5tPdS7qXPWG3C/_buildManifest.js" defer=""></script><script src="/_next/static/vLk7-bKM5tPdS7qXPWG3C/_ssgManifest.js" defer=""></script></head><body><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div dir="ltr"><script>document.documentElement.setAttribute('dir','ltr')</script><div class="nextra-nav-container nx-sticky nx-top-0 nx-z-20 nx-w-full nx-bg-transparent print:nx-hidden"><div class="nextra-nav-container-blur nx-pointer-events-none nx-absolute nx-z-[-1] nx-h-full nx-w-full nx-bg-white dark:nx-bg-dark nx-shadow-[0_2px_4px_rgba(0,0,0,.02),0_1px_0_rgba(0,0,0,.06)] dark:nx-shadow-[0_-1px_0_rgba(255,255,255,.1)_inset] contrast-more:nx-shadow-[0_0_0_1px_#000] contrast-more:dark:nx-shadow-[0_0_0_1px_#fff]"></div><nav class="nx-mx-auto nx-flex nx-h-[var(--nextra-navbar-height)] nx-max-w-[90rem] nx-items-center nx-justify-end nx-gap-2 nx-pl-[max(env(safe-area-inset-left),1.5rem)] nx-pr-[max(env(safe-area-inset-right),1.5rem)]"><a class="nx-flex nx-items-center hover:nx-opacity-75 ltr:nx-mr-auto rtl:nx-ml-auto" href="/"><span class="mr-2 font-extrabold hidden md:inline">üè• GlobeMed</span><span class="text-gray-600 font-normal hidden md:inline">Healthcare Management System Documentation</span></a><button type="button" aria-label="Menu" class="nextra-hamburger -nx-mr-2 nx-rounded nx-p-2 active:nx-bg-gray-400/20 md:nx-hidden"><svg fill="none" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" class=""><g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16"></path></g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 12h16"></path><g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 18h16"></path></g></svg></button></nav></div><div class="nx-mx-auto nx-flex nx-max-w-[90rem]"><div class="motion-reduce:nx-transition-none [transition:background-color_1.5s_ease] nx-bg-transparent"></div><aside class="nextra-sidebar-container nx-flex nx-flex-col md:nx-top-16 md:nx-shrink-0 motion-reduce:nx-transform-none nx-transform-gpu nx-transition-all nx-ease-in-out print:nx-hidden md:nx-w-64 md:nx-sticky md:nx-self-start max-md:[transform:translate3d(0,-100%,0)]"><div class="nx-px-4 nx-pt-4 md:nx-hidden"></div><div class="nx-overflow-y-auto nx-overflow-x-hidden nx-p-4 nx-grow md:nx-h-[calc(100vh-var(--nextra-navbar-height)-var(--nextra-menu-height))] nextra-scrollbar"><div class="nx-transform-gpu nx-overflow-hidden nx-transition-all nx-ease-in-out motion-reduce:nx-transition-none"><div class="nx-transition-opacity nx-duration-500 nx-ease-in-out motion-reduce:nx-transition-none nx-opacity-100"><ul class="nx-flex nx-flex-col nx-gap-1 nextra-menu-desktop max-md:nx-hidden"><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/">Introduction</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/overview/">System Overview</a></li><li class="[word-break:break-word] nx-mt-5 nx-mb-2 nx-px-2 nx-py-1.5 nx-text-sm nx-font-semibold nx-text-gray-900 first:nx-mt-0 dark:nx-text-gray-100"><div class="flex items-center gap-2 text-xs font-semibold text-gray-500 uppercase tracking-wide">Design Pattern Implementations</div></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/patient-records/">Patient Record Management</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/appointment-scheduling/">Appointment Scheduling</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/billing-insurance/">Billing &amp; Insurance Claims</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/staff-permissions/">Staff Roles &amp; Permissions</a></li><li class="nx-flex nx-flex-col nx-gap-1"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-text-gray-500 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:nx-text-neutral-400 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50 contrast-more:nx-text-gray-900 contrast-more:dark:nx-text-gray-50 contrast-more:nx-border-transparent contrast-more:hover:nx-border-gray-900 contrast-more:dark:hover:nx-border-gray-50" href="/medical-reports/">Medical Reports Generation</a></li><li class="nx-flex nx-flex-col nx-gap-1 active"><a class="nx-flex nx-rounded nx-px-2 nx-py-1.5 nx-text-sm nx-transition-colors [word-break:break-word] nx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:nx-border nx-bg-primary-100 nx-font-semibold nx-text-primary-800 dark:nx-bg-primary-400/10 dark:nx-text-primary-600 contrast-more:nx-border-primary-500 contrast-more:dark:nx-border-primary-500" href="/security/">Security Considerations</a></li></ul></div></div></div><div class="nx-sticky nx-bottom-0 nx-bg-white dark:nx-bg-dark nx-mx-4 nx-py-4 nx-shadow-[0_-12px_16px_#fff] nx-flex nx-items-center nx-gap-2 dark:nx-border-neutral-800 dark:nx-shadow-[0_-12px_16px_#111] contrast-more:nx-border-neutral-400 contrast-more:nx-shadow-none contrast-more:dark:nx-shadow-none nx-border-t" data-toggle-animation="off"><div class="nx-grow nx-flex nx-flex-col"><button title="Change theme" class="nx-h-7 nx-rounded-md nx-px-2 nx-text-left nx-text-xs nx-font-medium nx-text-gray-600 nx-transition-colors dark:nx-text-gray-400 hover:nx-bg-gray-100 hover:nx-text-gray-900 dark:hover:nx-bg-primary-100/5 dark:hover:nx-text-gray-50" id="headlessui-listbox-button-:Rlsr6:" type="button" aria-haspopup="listbox" aria-expanded="false" data-headlessui-state=""><div class="nx-flex nx-items-center nx-gap-2 nx-capitalize"><svg fill="none" viewBox="3 3 18 18" width="12" height="12" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" fill="currentColor" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg><span class="">Light</span></div></button></div></div></aside><nav class="nextra-toc nx-order-last nx-hidden nx-w-64 nx-shrink-0 xl:nx-block print:nx-hidden nx-px-4" aria-label="table of contents"><div class="nextra-scrollbar nx-sticky nx-top-16 nx-overflow-y-auto nx-pr-4 nx-pt-6 nx-text-sm [hyphens:auto] nx-max-h-[calc(100vh-var(--nextra-navbar-height)-env(safe-area-inset-bottom))] ltr:-nx-mr-4 rtl:-nx-ml-4"><p class="nx-mb-4 nx-font-semibold nx-tracking-tight">On This Page</p><ul><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#table-of-contents" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Table of Contents</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#1-overview--security-architecture" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">1. Overview &amp; Security Architecture</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#healthcare-security-requirements" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Healthcare Security Requirements</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#security-pattern-implementation" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Security Pattern Implementation</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#uml-class-diagram" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">UML Class Diagram</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#2-authentication-security-with-decorator-pattern" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">2. Authentication Security with Decorator Pattern</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#21-secure-authentication-service" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">2.1 Secure Authentication Service</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#22-secure-role-implementation" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">2.2 Secure Role Implementation</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#3-data-access-security-with-dao-pattern" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">3. Data Access Security with DAO Pattern</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#31-secure-patient-data-access" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">3.1 Secure Patient Data Access</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#32-secure-staff-management" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">3.2 Secure Staff Management</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#4-sql-injection-prevention" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">4. SQL Injection Prevention</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#41-consistent-prepared-statement-usage" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">4.1 Consistent Prepared Statement Usage</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#42-safe-parameter-handling" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">4.2 Safe Parameter Handling</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#5-role-based-access-control-security" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">5. Role-Based Access Control Security</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#51-permission-enforcement-in-controllers" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">5.1 Permission Enforcement in Controllers</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#52-context-aware-security-checks" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">5.2 Context-Aware Security Checks</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#6-database-security-implementation" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">6. Database Security Implementation</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#61-database-schema-security-features" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">6.1 Database Schema Security Features</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#62-connection-security" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">6.2 Connection Security</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#7-security-vulnerabilities--mitigations" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">7. Security Vulnerabilities &amp; Mitigations</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#71-current-security-vulnerabilities" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">7.1 Current Security Vulnerabilities</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#72-recommended-security-mitigations" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">7.2 Recommended Security Mitigations</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#8-security-best-practices-implemented" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">8. Security Best Practices Implemented</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#81-positive-security-features" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">8.1 Positive Security Features</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#82-security-architecture-benefits" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">8.2 Security Architecture Benefits</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#83-recommended-security-enhancements" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">8.3 Recommended Security Enhancements</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#9-conclusion" class="nx-font-semibold nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">9. Conclusion</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#security-strengths" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Security Strengths</a></li><li class="nx-my-2 nx-scroll-my-6 nx-scroll-py-6"><a href="#critical-security-improvements-needed" class="ltr:nx-pl-4 rtl:nx-pr-4 nx-inline-block nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-300 contrast-more:nx-text-gray-900 contrast-more:nx-underline contrast-more:dark:nx-text-gray-50 nx-w-full nx-break-words">Critical Security Improvements Needed</a></li></ul><div class="nx-mt-8 nx-border-t nx-bg-white nx-pt-8 nx-shadow-[0_-12px_16px_white] dark:nx-bg-dark dark:nx-shadow-[0_-12px_16px_#111] nx-sticky nx-bottom-0 nx-flex nx-flex-col nx-items-start nx-gap-2 nx-pb-8 dark:nx-border-neutral-800 contrast-more:nx-border-t contrast-more:nx-border-neutral-400 contrast-more:nx-shadow-none contrast-more:dark:nx-border-neutral-400"><a href="https://github.com/MacNaLK/GlobeMed-Healthcare-Management-System-Docs/issues/new?title=Feedback%20for%20%E2%80%9CSecurity%20Considerations%E2%80%9D&amp;labels=feedback" target="_blank" rel="noreferrer" class="nx-text-xs nx-font-medium nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-100 contrast-more:nx-text-gray-800 contrast-more:dark:nx-text-gray-50">Question? Give us feedback ‚Üí<span class="nx-sr-only nx-select-none"> (opens in a new tab)</span></a><a class="nx-text-xs nx-font-medium nx-text-gray-500 hover:nx-text-gray-900 dark:nx-text-gray-400 dark:hover:nx-text-gray-100 contrast-more:nx-text-gray-800 contrast-more:dark:nx-text-gray-50" href="https://github.com/MacNaLK/GlobeMed-Healthcare-Management-System-Docs/blob/main/pages/security.mdx">Edit this page on GitHub ‚Üí</a><div class="mt-8 text-xs text-gray-500"><p>üí° <strong>Tip:</strong> Use Ctrl+K to search</p></div></div></div></nav><div id="reach-skip-nav"></div><article class="nx-w-full nx-break-words nextra-content nx-flex nx-min-h-[calc(100vh-var(--nextra-navbar-height))] nx-min-w-0 nx-justify-center nx-pb-8 nx-pr-[calc(env(safe-area-inset-right)-1.5rem)]"><main class="nx-w-full nx-min-w-0 nx-max-w-6xl nx-px-6 nx-pt-4 md:nx-px-12"><div class="nextra-breadcrumb nx-mt-1.5 nx-flex nx-items-center nx-gap-1 nx-overflow-hidden nx-text-sm nx-text-gray-500 dark:nx-text-gray-400 contrast-more:nx-text-current"><div class="nx-whitespace-nowrap nx-transition-colors nx-font-medium nx-text-gray-700 contrast-more:nx-font-bold contrast-more:nx-text-current dark:nx-text-gray-100 contrast-more:dark:nx-text-current" title="Security Considerations">Security Considerations</div></div><h1 class="nx-mt-2 nx-text-4xl nx-font-bold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100">Part F: Security Considerations - Decorator &amp; DAO Patterns</h1>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>Document</strong>: Part F Analysis</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>Patterns</strong>: Decorator Pattern (Authentication), DAO Pattern (Data Access Security)</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>Module</strong>: Security Architecture and Data Protection</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>Author</strong>: Ishara Lakshitha</p>
<hr class="nx-my-8 nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400"/>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">Table of Contents<a href="#table-of-contents" id="table-of-contents" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<hr class="nx-my-8 nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400"/>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">1. Overview &amp; Security Architecture<a href="#1-overview--security-architecture" id="1-overview--security-architecture" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Healthcare Security Requirements<a href="#healthcare-security-requirements" id="healthcare-security-requirements" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>HIPAA Compliance Considerations</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">Patient data confidentiality and integrity protection</li>
<li class="nx-my-2">Access logging and audit trail requirements</li>
<li class="nx-my-2">Role-based access control for medical information</li>
<li class="nx-my-2">Secure authentication and authorization mechanisms</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>Critical Security Domains</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2"><strong>Authentication Security</strong>: User credential verification and session management</li>
<li class="nx-my-2"><strong>Authorization Security</strong>: Role-based permission enforcement</li>
<li class="nx-my-2"><strong>Data Access Security</strong>: Protected database operations and SQL injection prevention</li>
<li class="nx-my-2"><strong>Data Integrity</strong>: Ensuring medical records cannot be tampered with</li>
<li class="nx-my-2"><strong>Audit Trail</strong>: Comprehensive logging of all security-relevant operations</li>
</ul>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Security Pattern Implementation<a href="#security-pattern-implementation" id="security-pattern-implementation" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">The system implements security through two primary design patterns:</p>
<ol class="nx-mt-6 nx-list-decimal first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2"><strong>Decorator Pattern for Authentication/Authorization</strong>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">Layered security through role-based decorators</li>
<li class="nx-my-2">Dynamic permission assignment and verification</li>
<li class="nx-my-2">Secure user session management</li>
</ul>
</li>
<li class="nx-my-2"><strong>DAO Pattern for Data Access Security</strong>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">Centralized database access control</li>
<li class="nx-my-2">Prepared statement usage for SQL injection prevention</li>
<li class="nx-my-2">Consistent error handling and logging</li>
</ul>
</li>
</ol>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">UML Class Diagram<a href="#uml-class-diagram" id="uml-class-diagram" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><img alt="Part F - Security Considerations -¬†Decorator, DAO.png" loading="lazy" width="3840" height="2113" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 320 160&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAECAMAAACEE47CAAAABlBMVEX19fj9/f38PCHSAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAG0lEQVR4nGNgYGBkYGRkZGRgZAABKAPMgYkAAAElAA7OZMOEAAAAAElFTkSuQmCC&#x27;/%3E%3C/svg%3E&quot;)" src="/_next/static/media/Part_F_-_Security_Considerations_-_Decorator_DAO.5e19ad90.png"/></p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">(You can find the High Res images in the Github Project Repo)</p>
<hr class="nx-my-8 nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400"/>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">2. Authentication Security with Decorator Pattern<a href="#2-authentication-security-with-decorator-pattern" id="2-authentication-security-with-decorator-pattern" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">2.1 Secure Authentication Service<a href="#21-secure-authentication-service" id="21-secure-authentication-service" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="java" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="java" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * AuthService handles user authentication with security considerations</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">class</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">AuthService</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    /**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">     * Secure login implementation with prepared statements</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">     * Prevents SQL injection and implements proper error handling</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">     */</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IUser</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">login</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> username</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> password) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-comment)">// SECURITY: Use parameterized query to prevent SQL injection</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> sql </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;SELECT role, doctor_id FROM staff WHERE username = ? AND password_hash = ?&quot;</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">try</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Connection</span><span style="color:var(--shiki-color-text)"> conn </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DatabaseManager</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getConnection</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">             </span><span style="color:var(--shiki-token-keyword)">PreparedStatement</span><span style="color:var(--shiki-color-text)"> pstmt </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">conn</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">prepareStatement</span><span style="color:var(--shiki-color-text)">(sql)) {</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-comment)">// SECURITY: Set parameters to prevent injection attacks</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">1</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> username);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">2</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> password); </span><span style="color:var(--shiki-token-comment)">// Note: In production, this should be hashed</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">ResultSet</span><span style="color:var(--shiki-color-text)"> rs </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">executeQuery</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-constant)">rs</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">next</span><span style="color:var(--shiki-color-text)">()) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> role </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">rs</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;role&quot;</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> doctorId </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">rs</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;doctor_id&quot;</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-comment)">// Handle NULL values safely</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-constant)">rs</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">wasNull</span><span style="color:var(--shiki-color-text)">()) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                    doctorId </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">out</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">println</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;Login successful for user: &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> username </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot; with role: &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> role);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">decorateUser(username</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-token-function)"> role</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-token-function)"> doctorId)</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        } </span><span style="color:var(--shiki-token-keyword)">catch</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">SQLException</span><span style="color:var(--shiki-color-text)"> e) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-comment)">// SECURITY: Log errors without exposing sensitive information</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">err</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">println</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;Database error during login: &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">e</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getMessage</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-comment)">// SECURITY: Generic failure message to prevent user enumeration</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">out</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">println</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;Login failed for user: &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> username);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    /**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">     * SECURITY: Factory method that applies appropriate security decorators</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">     */</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IUser</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">decorateUser</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> username</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> role</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> doctorId) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">IUser</span><span style="color:var(--shiki-color-text)"> user </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">new</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">BaseUser(username</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-token-function)"> role</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-token-function)"> doctorId)</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-comment)">// Apply role-based security decorators</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">switch</span><span style="color:var(--shiki-color-text)"> (role) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;Doctor&quot;</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">new</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">DoctorRole(user)</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;Nurse&quot;</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">new</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">NurseRole(user)</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;Admin&quot;</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">new</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">AdminRole(user)</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">default:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-comment)">// SECURITY: Return base user with minimal permissions for unknown roles</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> user;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">2.2 Secure Role Implementation<a href="#22-secure-role-implementation" id="22-secure-role-implementation" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="java" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="java" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * DoctorRole decorator with specific security permissions</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">class</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">DoctorRole</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">extends</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">UserRoleDecorator</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    @</span><span style="color:var(--shiki-token-keyword)">Override</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">boolean</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">hasPermission</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> permission) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-comment)">// SECURITY: Explicit whitelist of doctor permissions</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">switch</span><span style="color:var(--shiki-color-text)"> (permission) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;can_access_appointments&quot;</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;can_mark_appointment_done&quot;</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;can_update_appointment&quot;</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;can_access_patients&quot;</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">case</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;can_add_appointment_notes&quot;</span><span style="color:var(--shiki-token-keyword)">:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">true</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">default:</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-comment)">// SECURITY: Delegate to parent for unknown permissions</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> super</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">hasPermission</span><span style="color:var(--shiki-color-text)">(permission);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * NurseRole decorator with restricted permissions</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">class</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">NurseRole</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">extends</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">UserRoleDecorator</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    @</span><span style="color:var(--shiki-token-keyword)">Override</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">boolean</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">hasPermission</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> permission) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-comment)">// SECURITY: Explicit permission whitelist for nurses</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">Set</span><span style="color:var(--shiki-color-text)">&lt;</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)">&gt; allowedPermissions </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">Set</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">of</span><span style="color:var(--shiki-color-text)">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;can_access_patients&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;can_access_appointments&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;can_generate_reports&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;can_book_appointment&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;can_cancel_appointment&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;can_update_appointment_reason&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        );</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-constant)">allowedPermissions</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">contains</span><span style="color:var(--shiki-color-text)">(permission)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">true</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-comment)">// SECURITY: Explicit denial of dangerous permissions</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">Set</span><span style="color:var(--shiki-color-text)">&lt;</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)">&gt; deniedPermissions </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">Set</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">of</span><span style="color:var(--shiki-color-text)">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;can_delete_patient&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;can_delete_appointment&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;can_delete_bill&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;can_access_billing&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;can_manage_staff&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        );</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-constant)">deniedPermissions</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">contains</span><span style="color:var(--shiki-color-text)">(permission)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">false</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> super</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">hasPermission</span><span style="color:var(--shiki-color-text)">(permission);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<hr class="nx-my-8 nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400"/>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">3. Data Access Security with DAO Pattern<a href="#3-data-access-security-with-dao-pattern" id="3-data-access-security-with-dao-pattern" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">3.1 Secure Patient Data Access<a href="#31-secure-patient-data-access" id="31-secure-patient-data-access" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="java" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="java" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * PatientDAO implements secure data access patterns</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">class</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">PatientDAO</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    /**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">     * SECURITY: Create patient with parameterized queries</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">     */</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">boolean</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">createPatient</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">PatientRecord</span><span style="color:var(--shiki-color-text)"> patient) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> sql </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;INSERT INTO patients (patient_id, full_name, medical_history, &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                    </span><span style="color:var(--shiki-token-string-expression)">&quot;treatment_plans, insurance_plan_id) VALUES (?, ?, ?, ?, ?)&quot;</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">try</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Connection</span><span style="color:var(--shiki-color-text)"> conn </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DatabaseManager</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getConnection</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">             </span><span style="color:var(--shiki-token-keyword)">PreparedStatement</span><span style="color:var(--shiki-color-text)"> pstmt </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">conn</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">prepareStatement</span><span style="color:var(--shiki-color-text)">(sql)) {</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-comment)">// SECURITY: Use prepared statement parameters</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">1</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">patient</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getPatientId</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">2</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">patient</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getName</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">3</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">String</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">join</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;\\n&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">patient</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getMedicalHistory</span><span style="color:var(--shiki-color-text)">()));</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">4</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">String</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">join</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;\\n&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">patient</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getTreatmentPlans</span><span style="color:var(--shiki-color-text)">()));</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-comment)">// SECURITY: Handle NULL values safely</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-constant)">patient</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getInsurancePlan</span><span style="color:var(--shiki-color-text)">() </span><span style="color:var(--shiki-token-keyword)">!=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setInt</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">5</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">patient</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getInsurancePlan</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getPlanId</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            } </span><span style="color:var(--shiki-token-keyword)">else</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setNull</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">5</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">Types</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">INTEGER</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">executeUpdate</span><span style="color:var(--shiki-color-text)">() </span><span style="color:var(--shiki-token-keyword)">&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">0</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        } </span><span style="color:var(--shiki-token-keyword)">catch</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">SQLException</span><span style="color:var(--shiki-color-text)"> e) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-comment)">// SECURITY: Log errors without exposing sensitive patient data</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">err</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">println</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;Error creating patient: &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">e</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getMessage</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">false</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    /**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">     * SECURITY: Safe patient deletion with parameterized query</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">     */</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">boolean</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">deletePatient</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> patientId) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> sql </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;DELETE FROM patients WHERE patient_id = ?&quot;</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">try</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Connection</span><span style="color:var(--shiki-color-text)"> conn </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DatabaseManager</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getConnection</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">             </span><span style="color:var(--shiki-token-keyword)">PreparedStatement</span><span style="color:var(--shiki-color-text)"> pstmt </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">conn</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">prepareStatement</span><span style="color:var(--shiki-color-text)">(sql)) {</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-comment)">// SECURITY: Parameterized query prevents injection</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">1</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> patientId);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">executeUpdate</span><span style="color:var(--shiki-color-text)">() </span><span style="color:var(--shiki-token-keyword)">&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">0</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        } </span><span style="color:var(--shiki-token-keyword)">catch</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">SQLException</span><span style="color:var(--shiki-color-text)"> e) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-comment)">// SECURITY: Generic error logging</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">err</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">println</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;Error deleting patient: &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">e</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getMessage</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">false</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">3.2 Secure Staff Management<a href="#32-secure-staff-management" id="32-secure-staff-management" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="java" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="java" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * StaffDAO with enhanced security for user account management</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">class</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">StaffDAO</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    /**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">     * SECURITY: Secure staff creation with duplicate prevention</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">     */</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">boolean</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">createStaff</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">Staff</span><span style="color:var(--shiki-color-text)"> staff) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-comment)">// SECURITY: Check for existing username to prevent duplicates</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-function)">getStaffByUsername(</span><span style="color:var(--shiki-token-constant)">staff</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getUsername())</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">err</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">println</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;Error: Staff with username &#x27;&quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">staff</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getUsername</span><span style="color:var(--shiki-color-text)">() </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;&#x27; already exists.&quot;</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">false</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> sql </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;INSERT INTO staff (username, password_hash, role, doctor_id) VALUES (?, ?, ?, ?)&quot;</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">try</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Connection</span><span style="color:var(--shiki-color-text)"> conn </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DatabaseManager</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getConnection</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">             </span><span style="color:var(--shiki-token-keyword)">PreparedStatement</span><span style="color:var(--shiki-color-text)"> pstmt </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">conn</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">prepareStatement</span><span style="color:var(--shiki-color-text)">(sql</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">Statement</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">RETURN_GENERATED_KEYS</span><span style="color:var(--shiki-color-text)">)) {</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-comment)">// SECURITY: Parameterized values prevent injection</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">1</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">staff</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getUsername</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">2</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">staff</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getPasswordHash</span><span style="color:var(--shiki-color-text)">()); </span><span style="color:var(--shiki-token-comment)">// Should be properly hashed</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">3</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">staff</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getRole</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-comment)">// SECURITY: Handle optional doctor_id safely</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-constant)">staff</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getDoctorId</span><span style="color:var(--shiki-color-text)">() </span><span style="color:var(--shiki-token-keyword)">!=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&amp;&amp;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-token-constant)">staff</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getDoctorId</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">isEmpty</span><span style="color:var(--shiki-color-text)">()) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">4</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">staff</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getDoctorId</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            } </span><span style="color:var(--shiki-token-keyword)">else</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setNull</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">4</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">java</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">sql</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">Types</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">VARCHAR</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">int</span><span style="color:var(--shiki-color-text)"> affectedRows </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">executeUpdate</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (affectedRows </span><span style="color:var(--shiki-token-keyword)">&gt;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">0</span><span style="color:var(--shiki-color-text)">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-comment)">// SECURITY: Update object with generated ID</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">try</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">ResultSet</span><span style="color:var(--shiki-color-text)"> generatedKeys </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getGeneratedKeys</span><span style="color:var(--shiki-color-text)">()) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                    </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-constant)">generatedKeys</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">next</span><span style="color:var(--shiki-color-text)">()) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                        </span><span style="color:var(--shiki-token-constant)">staff</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setStaffId</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">generatedKeys</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getInt</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">1</span><span style="color:var(--shiki-color-text)">));</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">true</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        } </span><span style="color:var(--shiki-token-keyword)">catch</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">SQLException</span><span style="color:var(--shiki-color-text)"> e) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-comment)">// SECURITY: Log error without exposing sensitive data</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">err</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">println</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;Error creating staff: &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">e</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getMessage</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">false</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">    /**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">     * SECURITY: Secure staff retrieval by username</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">     */</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Staff</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">getStaffByUsername</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> username) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> sql </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;SELECT staff_id, username, password_hash, role, doctor_id FROM staff WHERE username = ?&quot;</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">try</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Connection</span><span style="color:var(--shiki-color-text)"> conn </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DatabaseManager</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getConnection</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">             </span><span style="color:var(--shiki-token-keyword)">PreparedStatement</span><span style="color:var(--shiki-color-text)"> pstmt </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">conn</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">prepareStatement</span><span style="color:var(--shiki-color-text)">(sql)) {</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-comment)">// SECURITY: Parameterized query</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">1</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> username);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">ResultSet</span><span style="color:var(--shiki-color-text)"> rs </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">executeQuery</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-constant)">rs</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">next</span><span style="color:var(--shiki-color-text)">()) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">new</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">Staff(</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">                    </span><span style="color:var(--shiki-token-constant)">rs</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getInt(</span><span style="color:var(--shiki-token-string-expression)">&quot;staff_id&quot;</span><span style="color:var(--shiki-token-function)">)</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">                    </span><span style="color:var(--shiki-token-constant)">rs</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getString(</span><span style="color:var(--shiki-token-string-expression)">&quot;username&quot;</span><span style="color:var(--shiki-token-function)">)</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">                    </span><span style="color:var(--shiki-token-constant)">rs</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getString(</span><span style="color:var(--shiki-token-string-expression)">&quot;password_hash&quot;</span><span style="color:var(--shiki-token-function)">)</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">                    </span><span style="color:var(--shiki-token-constant)">rs</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getString(</span><span style="color:var(--shiki-token-string-expression)">&quot;role&quot;</span><span style="color:var(--shiki-token-function)">)</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">                    </span><span style="color:var(--shiki-token-constant)">rs</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getString(</span><span style="color:var(--shiki-token-string-expression)">&quot;doctor_id&quot;</span><span style="color:var(--shiki-token-function)">)</span></span>
<span class="line"><span style="color:var(--shiki-token-function)">                )</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        } </span><span style="color:var(--shiki-token-keyword)">catch</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">SQLException</span><span style="color:var(--shiki-color-text)"> e) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">err</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">println</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;Error fetching staff by username: &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">e</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getMessage</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<hr class="nx-my-8 nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400"/>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">4. SQL Injection Prevention<a href="#4-sql-injection-prevention" id="4-sql-injection-prevention" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">4.1 Consistent Prepared Statement Usage<a href="#41-consistent-prepared-statement-usage" id="41-consistent-prepared-statement-usage" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">The system consistently uses prepared statements across all DAO operations:</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="java" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="java" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">// GOOD: Parameterized query prevents SQL injection</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> sql </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;SELECT * FROM patients WHERE patient_id = ?&quot;</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">try</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Connection</span><span style="color:var(--shiki-color-text)"> conn </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DatabaseManager</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getConnection</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">     </span><span style="color:var(--shiki-token-keyword)">PreparedStatement</span><span style="color:var(--shiki-color-text)"> pstmt </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">conn</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">prepareStatement</span><span style="color:var(--shiki-color-text)">(sql)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">1</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> patientId);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">ResultSet</span><span style="color:var(--shiki-color-text)"> rs </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">executeQuery</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">// Process results...</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">// BAD: String concatenation vulnerable to injection (NOT used in system)</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)">// String sql = &quot;SELECT * FROM patients WHERE patient_id = &#x27;&quot; + patientId + &quot;&#x27;&quot;;</span></span>
<span class="line"> </span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">4.2 Safe Parameter Handling<a href="#42-safe-parameter-handling" id="42-safe-parameter-handling" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="java" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="java" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * Example of safe parameter handling in BillingDAO</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">int</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">saveBill(</span><span style="color:var(--shiki-token-keyword)">MedicalBill</span><span style="color:var(--shiki-token-function)"> bill)</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> sql </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;INSERT INTO billing (bill_id, patient_id, service_description, amount, &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-string-expression)">&quot;status, processing_log, final_amount, insurance_policy_number, &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-string-expression)">&quot;billed_datetime, amount_paid, insurance_paid_amount) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)&quot;</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">try</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Connection</span><span style="color:var(--shiki-color-text)"> conn </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DatabaseManager</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getConnection</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">         </span><span style="color:var(--shiki-token-keyword)">PreparedStatement</span><span style="color:var(--shiki-color-text)"> pstmt </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">conn</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">prepareStatement</span><span style="color:var(--shiki-color-text)">(sql</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">Statement</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">RETURN_GENERATED_KEYS</span><span style="color:var(--shiki-color-text)">)) {</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-comment)">// SECURITY: All parameters are safely set</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-constant)">bill</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getBillId</span><span style="color:var(--shiki-color-text)">() </span><span style="color:var(--shiki-token-keyword)">==</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">0</span><span style="color:var(--shiki-color-text)">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setNull</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">1</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">java</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">sql</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">Types</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">INTEGER</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        } </span><span style="color:var(--shiki-token-keyword)">else</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setInt</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">1</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">bill</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getBillId</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">2</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">bill</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getPatientId</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">3</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">bill</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getServiceDescription</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setDouble</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">4</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">bill</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getAmount</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">5</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">bill</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getStatus</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">6</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">bill</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getProcessingLog</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setDouble</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">7</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">bill</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getFinalAmount</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-comment)">// SECURITY: Handle nullable insurance plan safely</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">8</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">bill</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getAppliedInsurancePlan</span><span style="color:var(--shiki-color-text)">() </span><span style="color:var(--shiki-token-keyword)">!=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">?</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                       </span><span style="color:var(--shiki-token-constant)">bill</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getAppliedInsurancePlan</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getPlanName</span><span style="color:var(--shiki-color-text)">() </span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-comment)">// SECURITY: Safe timestamp handling</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-constant)">bill</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getBilledDateTime</span><span style="color:var(--shiki-color-text)">() </span><span style="color:var(--shiki-token-keyword)">!=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setTimestamp</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">9</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">Timestamp</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">valueOf</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">bill</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getBilledDateTime</span><span style="color:var(--shiki-color-text)">()));</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        } </span><span style="color:var(--shiki-token-keyword)">else</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setTimestamp</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">9</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">Timestamp</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">valueOf</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">LocalDateTime</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">now</span><span style="color:var(--shiki-color-text)">()));</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setDouble</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">10</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">bill</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getAmountPaid</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setDouble</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">11</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">bill</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getInsurancePaidAmount</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">executeUpdate</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    } </span><span style="color:var(--shiki-token-keyword)">catch</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">SQLException</span><span style="color:var(--shiki-color-text)"> e) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">err</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">println</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;Error saving bill: &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">e</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getMessage</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">-</span><span style="color:var(--shiki-token-constant)">1</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<hr class="nx-my-8 nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400"/>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">5. Role-Based Access Control Security<a href="#5-role-based-access-control-security" id="5-role-based-access-control-security" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">5.1 Permission Enforcement in Controllers<a href="#51-permission-enforcement-in-controllers" id="51-permission-enforcement-in-controllers" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="java" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="java" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * Example of RBAC implementation in patient management</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">void</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">deletePatient()</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">// SECURITY: Check permissions before any operation</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-token-constant)">currentUser</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">hasPermission</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;can_delete_patient&quot;</span><span style="color:var(--shiki-color-text)">)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">showMessageDialog</span><span style="color:var(--shiki-color-text)">(view</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;You do not have permission to delete patient records.&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;Access Denied&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">ERROR_MESSAGE</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (currentPatient </span><span style="color:var(--shiki-token-keyword)">==</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)">) </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">// SECURITY: Confirmation dialog for destructive operations</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">int</span><span style="color:var(--shiki-color-text)"> response </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">showConfirmDialog</span><span style="color:var(--shiki-color-text)">(view</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-string-expression)">&quot;Are you sure you want to delete patient &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">currentPatient</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getName</span><span style="color:var(--shiki-color-text)">() </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;?&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-string-expression)">&quot;Confirm Deletion&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">YES_NO_OPTION</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">WARNING_MESSAGE</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (response </span><span style="color:var(--shiki-token-keyword)">==</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">YES_OPTION</span><span style="color:var(--shiki-color-text)">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">boolean</span><span style="color:var(--shiki-color-text)"> success </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">dao</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">deletePatient</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">currentPatient</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getPatientId</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (success) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">showMessageDialog</span><span style="color:var(--shiki-color-text)">(view</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;Patient deleted successfully.&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-string-expression)">&quot;Success&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">INFORMATION_MESSAGE</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">view</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">clearFields</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        } </span><span style="color:var(--shiki-token-keyword)">else</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">showMessageDialog</span><span style="color:var(--shiki-color-text)">(view</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;Failed to delete patient.&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-string-expression)">&quot;Error&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">ERROR_MESSAGE</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * SECURITY: Staff management with administrative permissions</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">void</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">addStaff()</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-token-constant)">currentUser</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">hasPermission</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;can_manage_staff&quot;</span><span style="color:var(--shiki-color-text)">)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">showMessageDialog</span><span style="color:var(--shiki-color-text)">(mainFrame</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;You do not have permission to add staff members.&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;Access Denied&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">ERROR_MESSAGE</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">// Proceed with staff creation...</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">5.2 Context-Aware Security Checks<a href="#52-context-aware-security-checks" id="52-context-aware-security-checks" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="java" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="java" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * Example of context-aware security in appointment management</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">void</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">updatePrescription()</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">// SECURITY: Multiple layers of permission checking</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-token-constant)">currentUser</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">hasPermission</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;can_add_appointment_notes&quot;</span><span style="color:var(--shiki-color-text)">)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">showMessageDialog</span><span style="color:var(--shiki-color-text)">(mainFrame</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;You do not have permission to update prescriptions.&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;Access Denied&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">ERROR_MESSAGE</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">Appointment</span><span style="color:var(--shiki-color-text)"> selectedAppointment </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">view</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getSelectedAppointment</span><span style="color:var(--shiki-color-text)">(currentAppointments);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (selectedAppointment </span><span style="color:var(--shiki-token-keyword)">==</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">showMessageDialog</span><span style="color:var(--shiki-color-text)">(view</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;Please select an appointment to update prescription.&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;Warning&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">WARNING_MESSAGE</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">// SECURITY: Ownership verification for doctors</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-constant)">currentUser</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getDoctorId</span><span style="color:var(--shiki-color-text)">() </span><span style="color:var(--shiki-token-keyword)">==</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">||</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">!</span><span style="color:var(--shiki-token-constant)">currentUser</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getDoctorId</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">equals</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">selectedAppointment</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getDoctorId</span><span style="color:var(--shiki-color-text)">())) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">showMessageDialog</span><span style="color:var(--shiki-color-text)">(mainFrame</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;You can only update prescriptions for your own appointments.&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;Access Denied&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">ERROR_MESSAGE</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">// SECURITY: Status validation</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-string-expression)">&quot;Canceled&quot;</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">equalsIgnoreCase</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">selectedAppointment</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getStatus</span><span style="color:var(--shiki-color-text)">())) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">showMessageDialog</span><span style="color:var(--shiki-color-text)">(view</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;Cannot update prescription for canceled appointments.&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-string-expression)">&quot;Invalid Operation&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">JOptionPane</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">WARNING_MESSAGE</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">// Proceed with prescription update...</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<hr class="nx-my-8 nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400"/>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">6. Database Security Implementation<a href="#6-database-security-implementation" id="6-database-security-implementation" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">6.1 Database Schema Security Features<a href="#61-database-schema-security-features" id="61-database-schema-security-features" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">The database schema implements several security features:</p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="sql" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="sql" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">-- SECURITY: Foreign key constraints prevent orphaned records</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">CREATE</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">TABLE</span><span style="color:var(--shiki-color-text)"> `</span><span style="color:var(--shiki-token-function)">staff</span><span style="color:var(--shiki-color-text)">` (</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-string-expression)">`staff_id`</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">int</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">NOT NULL</span><span style="color:var(--shiki-color-text)"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-string-expression)">`username`</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">varchar</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">50</span><span style="color:var(--shiki-color-text)">) </span><span style="color:var(--shiki-token-keyword)">NOT NULL</span><span style="color:var(--shiki-color-text)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-string-expression)">`password_hash`</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">varchar</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">255</span><span style="color:var(--shiki-color-text)">) </span><span style="color:var(--shiki-token-keyword)">NOT NULL</span><span style="color:var(--shiki-color-text)">,  </span><span style="color:var(--shiki-token-comment)">-- Stores hashed passwords</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-string-expression)">`role`</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">varchar</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">50</span><span style="color:var(--shiki-color-text)">) </span><span style="color:var(--shiki-token-keyword)">NOT NULL</span><span style="color:var(--shiki-color-text)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-string-expression)">`doctor_id`</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">varchar</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">50</span><span style="color:var(--shiki-color-text)">) </span><span style="color:var(--shiki-token-keyword)">DEFAULT</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">NULL</span><span style="color:var(--shiki-color-text)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">PRIMARY KEY</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-string-expression)">`staff_id`</span><span style="color:var(--shiki-color-text)">),</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">UNIQUE</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">KEY</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">`username`</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-string-expression)">`username`</span><span style="color:var(--shiki-color-text)">),    </span><span style="color:var(--shiki-token-comment)">-- Prevents duplicate usernames</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">KEY</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">`doctor_id`</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-string-expression)">`doctor_id`</span><span style="color:var(--shiki-color-text)">),</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">CONSTRAINT</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">`fk_staff_doctor_id`</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">FOREIGN KEY</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-string-expression)">`doctor_id`</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">REFERENCES</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">`doctors`</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-string-expression)">`doctor_id`</span><span style="color:var(--shiki-color-text)">) </span><span style="color:var(--shiki-token-keyword)">ON DELETE</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">SET</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">NULL</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">) ENGINE</span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)">InnoDB;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">-- SECURITY: Patient data with insurance plan constraints</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">CREATE</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">TABLE</span><span style="color:var(--shiki-color-text)"> `</span><span style="color:var(--shiki-token-function)">patients</span><span style="color:var(--shiki-color-text)">` (</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-string-expression)">`patient_id`</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">varchar</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">50</span><span style="color:var(--shiki-color-text)">) </span><span style="color:var(--shiki-token-keyword)">NOT NULL</span><span style="color:var(--shiki-color-text)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-string-expression)">`full_name`</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">varchar</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">255</span><span style="color:var(--shiki-color-text)">) </span><span style="color:var(--shiki-token-keyword)">NOT NULL</span><span style="color:var(--shiki-color-text)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-string-expression)">`medical_history`</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">text</span><span style="color:var(--shiki-color-text)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-string-expression)">`treatment_plans`</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">text</span><span style="color:var(--shiki-color-text)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-string-expression)">`insurance_plan_id`</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">int</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">DEFAULT</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">NULL</span><span style="color:var(--shiki-color-text)">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">PRIMARY KEY</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-string-expression)">`patient_id`</span><span style="color:var(--shiki-color-text)">),</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">KEY</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">`insurance_plan_id`</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-string-expression)">`insurance_plan_id`</span><span style="color:var(--shiki-color-text)">),</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">  </span><span style="color:var(--shiki-token-keyword)">CONSTRAINT</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">`patients_ibfk_1`</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">FOREIGN KEY</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-string-expression)">`insurance_plan_id`</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">REFERENCES</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">`insurance_plans`</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-string-expression)">`plan_id`</span><span style="color:var(--shiki-color-text)">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">) ENGINE</span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)">InnoDB;</span></span>
<span class="line"> </span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">6.2 Connection Security<a href="#62-connection-security" id="62-connection-security" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="java" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="java" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * Note: The current implementation shows basic connection management</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * In production, this should include:</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * - Connection pooling for performance and security</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * - SSL/TLS encryption for data in transit</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * - Proper credential management (not hardcoded)</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">class</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">DatabaseManager</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-comment)">// SECURITY CONCERN: Credentials should not be hardcoded</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">final</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> JDBC_URL </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;jdbc:mysql://localhost:3306/globemed_db&quot;</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">final</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> USERNAME </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;root&quot;</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">final</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> PASSWORD </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;your_password&quot;</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Connection</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">getConnection</span><span style="color:var(--shiki-color-text)">() </span><span style="color:var(--shiki-token-keyword)">throws</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">SQLException</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (connection </span><span style="color:var(--shiki-token-keyword)">==</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">||</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">connection</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">isClosed</span><span style="color:var(--shiki-color-text)">()) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">try</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-constant)">Class</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">forName</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;com.mysql.cj.jdbc.Driver&quot;</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                connection </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DriverManager</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getConnection</span><span style="color:var(--shiki-color-text)">(JDBC_URL</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> USERNAME</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> PASSWORD);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">out</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">println</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;Database connection successful!&quot;</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            } </span><span style="color:var(--shiki-token-keyword)">catch</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">ClassNotFoundException</span><span style="color:var(--shiki-color-text)"> e) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">err</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">println</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;MySQL JDBC Driver not found.&quot;</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">throw</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">new</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">SQLException(</span><span style="color:var(--shiki-token-string-expression)">&quot;JDBC Driver not found&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-token-function)"> e)</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> connection;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<hr class="nx-my-8 nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400"/>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">7. Security Vulnerabilities &amp; Mitigations<a href="#7-security-vulnerabilities--mitigations" id="7-security-vulnerabilities--mitigations" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">7.1 Current Security Vulnerabilities<a href="#71-current-security-vulnerabilities" id="71-current-security-vulnerabilities" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>1. Password Storage</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2"><strong>Vulnerability</strong>: Passwords appear to be stored as plain text or simple hashes</li>
<li class="nx-my-2"><strong>Evidence</strong>: <code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr">password_hash</code> field contains values like &quot;1101&quot; in sample data</li>
<li class="nx-my-2"><strong>Risk</strong>: High - Compromised database exposes all user credentials</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>2. Database Credentials</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2"><strong>Vulnerability</strong>: Database credentials hardcoded in source code</li>
<li class="nx-my-2"><strong>Risk</strong>: Medium - Source code access exposes database credentials</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>3. No Connection Encryption</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2"><strong>Vulnerability</strong>: Database connections not encrypted</li>
<li class="nx-my-2"><strong>Risk</strong>: Medium - Data in transit vulnerable to interception</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>4. Limited Session Management</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2"><strong>Vulnerability</strong>: No apparent session timeout or management</li>
<li class="nx-my-2"><strong>Risk</strong>: Medium - Session hijacking possibilities</li>
</ul>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">7.2 Recommended Security Mitigations<a href="#72-recommended-security-mitigations" id="72-recommended-security-mitigations" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>1. Implement Proper Password Hashing</strong></p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="java" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="java" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * RECOMMENDED: Secure password hashing implementation</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">class</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">PasswordSecurity</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">final</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">BCryptPasswordEncoder</span><span style="color:var(--shiki-color-text)"> encoder </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">new</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">BCryptPasswordEncoder(</span><span style="color:var(--shiki-token-constant)">12</span><span style="color:var(--shiki-token-function)">)</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">hashPassword</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> plainPassword) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">encoder</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">encode</span><span style="color:var(--shiki-color-text)">(plainPassword);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">boolean</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">verifyPassword</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> plainPassword</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> hashedPassword) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">encoder</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">matches</span><span style="color:var(--shiki-color-text)">(plainPassword</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> hashedPassword);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-token-comment)">// Updated AuthService login method</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IUser</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">login(</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-token-function)"> username</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-token-function)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-token-function)"> password)</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> sql </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;SELECT role, doctor_id, password_hash FROM staff WHERE username = ?&quot;</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">try</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">Connection</span><span style="color:var(--shiki-color-text)"> conn </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DatabaseManager</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getConnection</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">         </span><span style="color:var(--shiki-token-keyword)">PreparedStatement</span><span style="color:var(--shiki-color-text)"> pstmt </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">conn</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">prepareStatement</span><span style="color:var(--shiki-color-text)">(sql)) {</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">setString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-constant)">1</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> username);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">ResultSet</span><span style="color:var(--shiki-color-text)"> rs </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">pstmt</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">executeQuery</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-constant)">rs</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">next</span><span style="color:var(--shiki-color-text)">()) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> storedHash </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">rs</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;password_hash&quot;</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-comment)">// SECURITY: Verify password against hash</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-constant)">PasswordSecurity</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">verifyPassword</span><span style="color:var(--shiki-color-text)">(password</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> storedHash)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> role </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">rs</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;role&quot;</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> doctorId </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">rs</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getString</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;doctor_id&quot;</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">                </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">decorateUser(username</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-token-function)"> role</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-token-function)"> doctorId)</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    } </span><span style="color:var(--shiki-token-keyword)">catch</span><span style="color:var(--shiki-color-text)"> (</span><span style="color:var(--shiki-token-keyword)">SQLException</span><span style="color:var(--shiki-color-text)"> e) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">err</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">println</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;Database error during login: &quot;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">e</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getMessage</span><span style="color:var(--shiki-color-text)">());</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>2. Environment-Based Configuration</strong></p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="java" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="java" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * RECOMMENDED: Secure configuration management</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">class</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">DatabaseManager</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">final</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> JDBC_URL </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getenv</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;DB_URL&quot;</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">final</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> USERNAME </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getenv</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;DB_USERNAME&quot;</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">final</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> PASSWORD </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getenv</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-string-expression)">&quot;DB_PASSWORD&quot;</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Connection</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">getConnection</span><span style="color:var(--shiki-color-text)">() </span><span style="color:var(--shiki-token-keyword)">throws</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">SQLException</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (JDBC_URL </span><span style="color:var(--shiki-token-keyword)">==</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">||</span><span style="color:var(--shiki-color-text)"> USERNAME </span><span style="color:var(--shiki-token-keyword)">==</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">||</span><span style="color:var(--shiki-color-text)"> PASSWORD </span><span style="color:var(--shiki-token-keyword)">==</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">throw</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">new</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">SQLException(</span><span style="color:var(--shiki-token-string-expression)">&quot;Database configuration not properly set&quot;</span><span style="color:var(--shiki-token-function)">)</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-comment)">// Add SSL parameters for encrypted connections</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> secureUrl </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> JDBC_URL </span><span style="color:var(--shiki-token-keyword)">+</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-string-expression)">&quot;?useSSL=true&amp;requireSSL=true&amp;verifyServerCertificate=true&quot;</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">DriverManager</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">getConnection</span><span style="color:var(--shiki-color-text)">(secureUrl</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> USERNAME</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> PASSWORD);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>3. Session Management Enhancement</strong></p>
<div class="nextra-code-block nx-relative nx-mt-6 first:nx-mt-0"><pre class="nx-bg-primary-700/5 nx-mb-4 nx-overflow-x-auto nx-rounded-xl nx-subpixel-antialiased dark:nx-bg-primary-300/10 nx-text-[.9em] contrast-more:nx-border contrast-more:nx-border-primary-900/20 contrast-more:nx-contrast-150 contrast-more:dark:nx-border-primary-100/40 nx-py-4" data-language="java" data-theme="default"><code class="nx-border-black nx-border-opacity-[0.04] nx-bg-opacity-[0.03] nx-bg-black nx-break-words nx-rounded-md nx-border nx-py-0.5 nx-px-[.25em] nx-text-[.9em] dark:nx-border-white/10 dark:nx-bg-white/10" dir="ltr" data-language="java" data-theme="default"><span class="line"><span style="color:var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> * RECOMMENDED: Secure session management</span></span>
<span class="line"><span style="color:var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">class</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">SessionManager</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">final</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">Map</span><span style="color:var(--shiki-color-text)">&lt;</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">UserSession</span><span style="color:var(--shiki-color-text)">&gt; activeSessions </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">new</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">ConcurrentHashMap</span><span style="color:var(--shiki-color-text)">&lt;&gt;();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">final</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">long</span><span style="color:var(--shiki-color-text)"> SESSION_TIMEOUT </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">30</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">*</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">60</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">*</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">1000</span><span style="color:var(--shiki-color-text)">; </span><span style="color:var(--shiki-token-comment)">// 30 minutes</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">class</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">UserSession</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">final</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IUser</span><span style="color:var(--shiki-color-text)"> user;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">final</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">long</span><span style="color:var(--shiki-color-text)"> createdTime;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">private</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">long</span><span style="color:var(--shiki-color-text)"> lastAccessTime;</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">UserSession</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">IUser</span><span style="color:var(--shiki-color-text)"> user) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">this</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">user</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> user;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">this</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">createdTime</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">currentTimeMillis</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">this</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">lastAccessTime</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> createdTime;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">boolean</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">isValid</span><span style="color:var(--shiki-color-text)">() {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">long</span><span style="color:var(--shiki-color-text)"> currentTime </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">currentTimeMillis</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> (currentTime </span><span style="color:var(--shiki-token-keyword)">-</span><span style="color:var(--shiki-color-text)"> lastAccessTime) </span><span style="color:var(--shiki-token-keyword)">&lt;</span><span style="color:var(--shiki-color-text)"> SESSION_TIMEOUT;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">void</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">updateAccess</span><span style="color:var(--shiki-color-text)">() {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">this</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">lastAccessTime</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">System</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">currentTimeMillis</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">createSession</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">IUser</span><span style="color:var(--shiki-color-text)"> user) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> sessionId </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">UUID</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">randomUUID</span><span style="color:var(--shiki-color-text)">()</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">toString</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-constant)">activeSessions</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">put</span><span style="color:var(--shiki-color-text)">(sessionId</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">new</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">UserSession(user)</span><span style="color:var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> sessionId;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"> </span>
<span class="line"><span style="color:var(--shiki-color-text)">    </span><span style="color:var(--shiki-token-keyword)">public</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">static</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">IUser</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-function)">getUser</span><span style="color:var(--shiki-color-text)">(</span><span style="color:var(--shiki-token-keyword)">String</span><span style="color:var(--shiki-color-text)"> sessionId) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">UserSession</span><span style="color:var(--shiki-color-text)"> session </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">activeSessions</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">get</span><span style="color:var(--shiki-color-text)">(sessionId);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        </span><span style="color:var(--shiki-token-keyword)">if</span><span style="color:var(--shiki-color-text)"> (session </span><span style="color:var(--shiki-token-keyword)">!=</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-keyword)">&amp;&amp;</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">session</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">isValid</span><span style="color:var(--shiki-color-text)">()) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">session</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">updateAccess</span><span style="color:var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">session</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-constant)">user</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        } </span><span style="color:var(--shiki-token-keyword)">else</span><span style="color:var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-constant)">activeSessions</span><span style="color:var(--shiki-token-punctuation)">.</span><span style="color:var(--shiki-token-function)">remove</span><span style="color:var(--shiki-color-text)">(sessionId);</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">            </span><span style="color:var(--shiki-token-keyword)">return</span><span style="color:var(--shiki-color-text)"> </span><span style="color:var(--shiki-token-constant)">null</span><span style="color:var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text)">}</span></span>
<span class="line"> </span></code></pre><div class="nx-opacity-0 nx-transition [div:hover&gt;&amp;]:nx-opacity-100 focus-within:nx-opacity-100 nx-flex nx-gap-1 nx-absolute nx-m-[11px] nx-right-0 nx-top-0"><button class="nextra-button nx-transition-all active:nx-opacity-50 nx-bg-primary-700/5 nx-border nx-border-black/5 nx-text-gray-600 hover:nx-text-gray-900 nx-rounded-md nx-p-1.5 dark:nx-bg-primary-300/10 dark:nx-border-white/10 dark:nx-text-gray-400 dark:hover:nx-text-gray-50 md:nx-hidden" title="Toggle word wrap"><svg viewBox="0 0 24 24" width="24" height="24" class="nx-pointer-events-none nx-h-4 nx-w-4"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button></div></div>
<hr class="nx-my-8 nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400"/>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">8. Security Best Practices Implemented<a href="#8-security-best-practices-implemented" id="8-security-best-practices-implemented" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">8.1 Positive Security Features<a href="#81-positive-security-features" id="81-positive-security-features" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>1. Consistent Use of Prepared Statements</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">All database operations use parameterized queries</li>
<li class="nx-my-2">Prevents SQL injection attacks across the entire application</li>
<li class="nx-my-2">Proper handling of NULL values and data types</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>2. Role-Based Access Control</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">Clear separation of permissions by user role</li>
<li class="nx-my-2">Explicit permission checking before sensitive operations</li>
<li class="nx-my-2">Decorator pattern enables flexible permission management</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>3. Input Validation and Error Handling</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">Proper validation of user inputs before database operations</li>
<li class="nx-my-2">Generic error messages to prevent information disclosure</li>
<li class="nx-my-2">Consistent error logging without exposing sensitive data</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>4. Database Integrity Constraints</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">Foreign key constraints prevent data corruption</li>
<li class="nx-my-2">Unique constraints prevent duplicate critical data</li>
<li class="nx-my-2">Proper use of NOT NULL constraints for required fields</li>
</ul>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">8.2 Security Architecture Benefits<a href="#82-security-architecture-benefits" id="82-security-architecture-benefits" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>1. Defense in Depth</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">Multiple layers of security (authentication, authorization, data access)</li>
<li class="nx-my-2">Permission checks at both UI and business logic levels</li>
<li class="nx-my-2">Database constraints as final layer of protection</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>2. Principle of Least Privilege</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">Users only receive minimum necessary permissions</li>
<li class="nx-my-2">Role-based restrictions properly implemented</li>
<li class="nx-my-2">Context-aware permission checking (e.g., doctors can only modify their own appointments)</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>3. Secure by Default</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">Base users have no permissions by default</li>
<li class="nx-my-2">Unknown roles receive minimal access</li>
<li class="nx-my-2">Explicit permission grants rather than denials</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>4. Audit and Logging</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">Comprehensive logging of authentication attempts</li>
<li class="nx-my-2">Error logging for security monitoring</li>
<li class="nx-my-2">User action tracking for audit trails</li>
</ul>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">8.3 Recommended Security Enhancements<a href="#83-recommended-security-enhancements" id="83-recommended-security-enhancements" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>1. Immediate Priority</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">Implement proper password hashing (bcrypt/scrypt)</li>
<li class="nx-my-2">Move database credentials to environment variables</li>
<li class="nx-my-2">Add SSL/TLS encryption for database connections</li>
<li class="nx-my-2">Implement session timeout management</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>2. Medium Priority</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">Add comprehensive audit logging</li>
<li class="nx-my-2">Implement rate limiting for login attempts</li>
<li class="nx-my-2">Add input sanitization beyond SQL injection prevention</li>
<li class="nx-my-2">Create security configuration management</li>
</ul>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>3. Long-term Security</strong></p>
<ul class="nx-mt-6 nx-list-disc first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2">Implement multi-factor authentication</li>
<li class="nx-my-2">Add encryption for sensitive data at rest</li>
<li class="nx-my-2">Create comprehensive security testing framework</li>
<li class="nx-my-2">Implement automated security monitoring</li>
</ul>
<hr class="nx-my-8 nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400"/>
<h2 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-10 nx-border-b nx-pb-1 nx-text-3xl nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400">9. Conclusion<a href="#9-conclusion" id="9-conclusion" class="subheading-anchor" aria-label="Permalink for this section"></a></h2>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">The GlobeMed Healthcare Management System demonstrates a solid foundation for security through the strategic use of the Decorator and DAO patterns. The Decorator pattern provides flexible and extensible role-based access control, while the DAO pattern ensures consistent and secure data access practices throughout the application.</p>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Security Strengths<a href="#security-strengths" id="security-strengths" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<ol class="nx-mt-6 nx-list-decimal first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2"><strong>Comprehensive SQL Injection Prevention</strong>: Consistent use of prepared statements across all database operations provides strong protection against injection attacks.</li>
<li class="nx-my-2"><strong>Robust Role-Based Access Control</strong>: The Decorator pattern implementation enables fine-grained permission management with clear separation between different user roles.</li>
<li class="nx-my-2"><strong>Secure Data Access Patterns</strong>: The DAO pattern centralizes database operations and ensures consistent security practices across all data access points.</li>
<li class="nx-my-2"><strong>Defense in Depth</strong>: Multiple layers of security checking from UI controls through business logic to database constraints.</li>
</ol>
<h3 class="nx-font-semibold nx-tracking-tight nx-text-slate-900 dark:nx-text-slate-100 nx-mt-8 nx-text-2xl">Critical Security Improvements Needed<a href="#critical-security-improvements-needed" id="critical-security-improvements-needed" class="subheading-anchor" aria-label="Permalink for this section"></a></h3>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">While the architectural foundation is strong, several critical security enhancements are required for production deployment:</p>
<ol class="nx-mt-6 nx-list-decimal first:nx-mt-0 ltr:nx-ml-6 rtl:nx-mr-6">
<li class="nx-my-2"><strong>Password Security</strong>: Implementation of proper cryptographic hashing for password storage</li>
<li class="nx-my-2"><strong>Configuration Security</strong>: Migration of hardcoded credentials to secure configuration management</li>
<li class="nx-my-2"><strong>Transport Security</strong>: Addition of SSL/TLS encryption for all database communications</li>
<li class="nx-my-2"><strong>Session Management</strong>: Implementation of secure session handling with appropriate timeouts</li>
</ol>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0">The current implementation provides an excellent foundation that, with the recommended security enhancements, would meet healthcare industry security standards and regulatory requirements such as HIPAA compliance.</p>
<hr class="nx-my-8 nx-border-neutral-200/70 contrast-more:nx-border-neutral-400 dark:nx-border-primary-100/10 contrast-more:dark:nx-border-neutral-400"/>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>Document Status</strong>: Part F Complete - Security Analysis</p>
<p class="nx-mt-6 nx-leading-7 first:nx-mt-0"><strong>Pattern Analysis Series</strong>: Complete (Parts A-F) - All major design patterns and security considerations analyzed</p><div class="nx-mt-16"></div><div class="nx-mb-8 nx-flex nx-items-center nx-border-t nx-pt-8 dark:nx-border-neutral-800 contrast-more:nx-border-neutral-400 dark:contrast-more:nx-border-neutral-400 print:nx-hidden"><a title="Medical Reports Generation" class="nx-flex nx-max-w-[50%] nx-items-center nx-gap-1 nx-py-4 nx-text-base nx-font-medium nx-text-gray-600 nx-transition-colors [word-break:break-word] hover:nx-text-primary-600 dark:nx-text-gray-300 md:nx-text-lg ltr:nx-pr-4 rtl:nx-pl-4" href="/medical-reports/"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="nx-inline nx-h-5 nx-shrink-0 ltr:nx-rotate-180"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>Medical Reports Generation</a></div></main></article></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/security","query":{},"buildId":"vLk7-bKM5tPdS7qXPWG3C","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>